<script>
  // 3a) Obrázky galerie (přidej kolik chceš)
  const GALLERY_IMAGES = [
    "https://grafitctu.github.io/assets/showcase/FitLife.png",
    "https://grafitctu.github.io/assets/showcase/img_vhs_1.png",
    "https://grafitctu.github.io/assets/showcase/img_vhs_2.png",
    "https://grafitctu.github.io/assets/showcase/img_vhs_3.png",
    "https://grafitctu.github.io/assets/showcase/img_vhs_4.png"
  ];

  // 3b) Ultralehký carousel
  function initCarousel(elId, images){
    const el = document.getElementById(elId);
    if(!el || !images?.length) return;

    // vytvoření slideů
    images.forEach((src,i)=>{
      const slide = document.createElement("div");
      slide.className = "slide" + (i===0 ? " active" : "");
      const img = new Image();
      img.src = src; img.alt = "Screenshot "+(i+1);
      img.loading = i>0 ? "lazy" : "eager";
      slide.appendChild(img);
      el.appendChild(slide);
    });

    // tečky
    const dotsWrap = el.querySelector(".dots");
    const dots = images.map((_,i)=>{
      const d=document.createElement("button");
      d.className = "dot"+(i===0?" active":"");
      d.setAttribute("aria-label","Snímek "+(i+1));
      d.addEventListener("click",()=>go(i));
      dotsWrap.appendChild(d);
      return d;
    });

    // šipky
    const prevBtn = el.querySelector(".carousel-btn.prev");
    const nextBtn = el.querySelector(".carousel-btn.next");

    let idx = 0;
    const slides = Array.from(el.querySelectorAll(".slide"));

    function go(n){
      slides[idx].classList.remove("active");
      dots[idx].classList.remove("active");
      idx = (n+slides.length) % slides.length;
      slides[idx].classList.add("active");
      dots[idx].classList.add("active");
      // pre-load next/prev
      const next = (idx+1)%slides.length, prev=(idx-1+slides.length)%slides.length;
      [idx,next,prev].forEach(i=>{
        const im = slides[i].querySelector("img");
        if(im && im.loading==="lazy"){ im.loading="eager"; }
      });
    }

    prevBtn?.addEventListener("click",()=>go(idx-1));
    nextBtn?.addEventListener("click",()=>go(idx+1));

    // klávesy
    el.setAttribute("tabindex","0");
    el.addEventListener("keydown",(e)=>{
      if(e.key==="ArrowLeft") go(idx-1);
      if(e.key==="ArrowRight") go(idx+1);
    });

    // swipe (touch)
    let sx=0, sy=0;
    el.addEventListener("touchstart",(e)=>{ sx=e.touches[0].clientX; sy=e.touches[0].clientY; }, {passive:true});
    el.addEventListener("touchend",(e)=>{
      const dx = (e.changedTouches[0].clientX - sx);
      const dy = Math.abs(e.changedTouches[0].clientY - sy);
      if(Math.abs(dx) > 40 && dy < 50){ dx>0 ? go(idx-1) : go(idx+1); }
    });

    // Auto-pause on reduced motion
    const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    if(!prefersReduced){
      // volitelně: auto-advance
      // let timer = setInterval(()=>go(idx+1), 6000);
      // el.addEventListener("mouseenter",()=>clearInterval(timer));
      // el.addEventListener("mouseleave",()=> timer=setInterval(()=>go(idx+1),6000));
    }
  }

  // 3c) Spusť po načtení (po tvém ostatním initu)
  document.addEventListener("DOMContentLoaded", ()=> {
    initCarousel("gallery", GALLERY_IMAGES);
  });
</script>
