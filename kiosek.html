<!doctype html>
<html lang="cs" class="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Grafit — Kiosk rotace karet</title>
  <!-- Tailwind (Play CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    html,body { height:100%; }
    html { scroll-behavior: smooth; }
    /* Karta + přechody */
    .card { transition: transform 300ms cubic-bezier(.2,.8,.2,1), box-shadow 300ms ease; box-shadow: 0 10px 30px rgba(0,0,0,0.15); }
    .card .thumb { transform: scale(1.02); transition: transform 600ms cubic-bezier(.22,1,.36,1); }
    .card:hover .thumb { transform: scale(1.06); }
    .fade-enter { opacity: 0; transform: translateY(6px) scale(.995); }
    .fade-enter-active { opacity: 1; transform: translateY(0) scale(1); transition: opacity 500ms ease, transform 500ms ease; }
    .fade-exit { opacity: 1; transform: translateY(0) scale(1); }
    .fade-exit-active { opacity: 0; transform: translateY(-6px) scale(.995); transition: opacity 400ms ease, transform 400ms ease; }
    /* Pozadí */
    .bg-gradient-dark { background: linear-gradient(#070b12,#0a0f18 55%,#090d14); }
  </style>
</head>
<body class="min-h-screen bg-gradient-dark text-white">

  <!-- animované pozadí -->
  <canvas id="backCanvas" class="fixed inset-0 w-full h-full"></canvas>

  <!-- horní lišta s titulem a stavem -->
  <header class="pointer-events-none fixed left-0 right-0 top-0 z-20">
    <div class="mx-auto max-w-[1400px] px-4 xl:px-6 py-4 flex items-center justify-between text-sm text-neutral-300/90">
      <div class="pointer-events-auto rounded-full border border-white/15 bg-black/30 px-3 py-1.5 backdrop-blur">
        Grafit Research Group — slideshow
      </div>
      <div id="status" class="pointer-events-auto rounded-full border border-white/15 bg-black/30 px-3 py-1.5 backdrop-blur">
        ⏵ běží · 15 s
      </div>
    </div>
  </header>

  <!-- středová oblast pro kartu -->
  <main class="relative z-10 min-h-screen flex items-center justify-center px-4">
    <div id="stage" class="w-[min(1200px,95vw)]"></div>
  </main>

  <!-- drobné ovládání vpravo dole -->
  <div class="fixed right-4 bottom-4 z-20 flex gap-2">
    <button id="btnPrev" class="rounded-full border border-white/15 bg-black/40 px-3 py-1.5 text-sm hover:bg-white/10">← Předchozí</button>
    <button id="btnToggle" class="rounded-full border border-white/15 bg-black/40 px-3 py-1.5 text-sm hover:bg-white/10">⏸ Pauza</button>
    <button id="btnNext" class="rounded-full border border-white/15 bg-black/40 px-3 py-1.5 text-sm hover:bg-white/10">Další →</button>
  </div>

  <script>
    /* ====== DATA (stejná jako na hlavní stránce) ====== */
    const EVENTS = [
      { id:"e-gamejam-2025", title:"GameJam 2025", blurb:"Another installment in our series of traditional game jams! Once again over Easter, this time with a surprise – judges from game studios and major companies.", img:"/assets/projects/majak2.png", href:"https://itch.io/jam/gamejam-fit-2025a", tags:["event","gamejam","community"], date:"Spring 2025" },
      { id:"e-hellofit-2025", title:"HelloFit 2025", blurb:"Part of our traditional freshmen events. We teamed up with Fit++, welcomed new students and invited them to our game design group and the STOH board-game club.", img:"/events/hellofit.jpg", href:"https://www.klubfitpp.cz/events/2025/hello-fit-25/", tags:["event","community","onboarding"], date:"2025" },
      { id:"e-gamejam-2024", title:"GameJam 2024", blurb:"Another traditional jam. Christmas edition with industry judges from game studios and major companies.", img:"/assets/projects/gamejam_2024b_logo.jpg", href:"https://itch.io/jam/gamejam-fit-2024-vanocni", tags:["event","gamejam"], date:"Dec 2024" },
      { id:"e-gexpo-2025", title:"GEXPO 2025", blurb:"Graphics Expo showcasing achievements of our students in game development, VR, and final projects. 60+ participants and a packed evening program.", img:"/assets/projects/gexpo_logo.jpg", href:"events/gexpo/2025", tags:["event","expo","students","vr","games"], date:"2025" },
      { id:"e-researchers-night-2025", title:"ResearchersNight 2025", blurb:"Celebrating 20 years of Researchers' Night in the Czech Republic across 50+ cities.", img:"/assets/projects/nocvedcu.png", href:"https://www.nocvedcu.cz/en", tags:["event","public","research"], date:"26 Sep 2025" },
      { id:"e-grafit-games-studio", title:"Grafit Games Studio", blurb:"Bridging cutting-edge research with creative game development across digital and board games.", img:"/assets/projects/grafitgames_logo.jpg", href:"https://barushe22.itch.io/neckventure", tags:["studio","games","event"], date:"ongoing" }
    ];
    const RESEARCH = [
      { id:"r-politeia21", title:"Politeia 21", blurb:"Interdisciplinary VR project exploring Plato’s theses, ethics and human behavior in a large-scale social simulation.", img:"/assets/projects/politeia.png", href:"https://www.unihack.cz/project/8", tags:["vr","simulation","social","philosophy","research"] },
      { id:"r-dowry-towns", title:"Dowry Towns of Bohemian Queens", blurb:"Projects mapping historical development and digitizing cultural heritage of royal dowry towns; VR reconstructions and archives.", img:"/assets/projects/vennamesta.png", href:"https://www.kralovskavennamesta.cz/", tags:["heritage","mapping","history","vr"], date:"2018–2022" },
      { id:"r-game-design", title:"Game design", blurb:"Research in game design theory: world design, accessibility for impaired users, and creative writing.", img:"/assets/projects/gamedesign.png", href:"/projects/", tags:["games","design","accessibility","writing"] },
      { id:"r-texture-modeling", title:"Texture modeling", blurb:"With the Institute of Information Theory and Automation (CAS), we analyze and model realistic material appearance (BRDF/BTF).", img:"/assets/projects/textures.jpg", href:"http://btf.utia.cas.cz/?brdf_dwn", tags:["materials","brdf","btf","collaboration"] },
      { id:"r-most-city", title:"Most – city that did not disappear", blurb:"Reconstruction of the historic appearance of the city of Most prior to its major redevelopment.", img:"/assets/projects/most.png", href:"https://www.vugtk.cz/en/home-page/", tags:["heritage","reconstruction","city","3d"], date:"2023–2027" },
      { id:"r-tactile-wall", title:"Tactile interfaces: interactive wall", blurb:"Exploration of tactile-specific interfaces in collaboration with MIT, University of Tokyo, initi.org and CAMP.", img:"/assets/projects/intwall.png", href:"https://www.youtube.com/watch?v=3jvmoj7pLZU&ab_channel=IraWinder", tags:["haptics","ui","installation","collaboration"] }
    ];
    const SHOWCASE = [
      { id:"sc-wood-texture-generation", title:"Wood texture generation", blurb:"Plugin for creating artificial wood texture.", img:"/assets/showcase/jechdrevo.png", href:"https://iga.ksi.fit.cvut.cz/bi-pga/b241/3d/jechjose?class=3d", tags:["pga","texture","bachelor"] },
      { id:"sc-ai-texture-to-3d", title:"AI Texture to 3D generation", img:"/assets/showcase/stablegen.jpg", href:"https://stablegen.ai", tags:["pga","ai","texture","3d","bachelor"] },
      { id:"sc-texture-editing", title:"Texture editing", img:"/assets/showcase/svabova.png", href:"https://gitlab.fit.cvut.cz/BI-PGA/stud/svabosa1/blob/master/dokumentace1.adoc", tags:["pga","gimp","content-aware"] },
      { id:"sc-elections-visualisation", title:"Elections visualisation", img:"/assets/showcase/milec.png", href:"https://gitlab.fit.cvut.cz/BI-PGA/stud/milecold/blob/master/dokumentace2.adoc", tags:["pga","visualization","sage","parser"] },
      { id:"sc-edge-detectors", title:"Edge detectors", img:"/assets/showcase/hoskorad.jpg", href:"https://gitlab.fit.cvut.cz/BI-PGA/stud/hoskorad/blob/master/dokumentace1.adoc", tags:["pga","gimp","edge-detection"] },
      { id:"sc-3d-ft-visualisation", title:"3D FT visualisation", img:"/assets/showcase/valko.png", href:"https://gitlab.fit.cvut.cz/BI-PGA/b201/valkojo1/tree/master/3D", tags:["pga","blender","fourier","3d"] },
      { id:"sc-parametric-towers", title:"Parametric towers generation", img:"/assets/showcase/trzasmar.jpg", href:"https://gitlab.fit.cvut.cz/BI-PGA/b201/trzasmar/blob/master/3D-object_generator/dokumentace3.adoc", tags:["pga","blender","procedural"] },
      { id:"sc-mandelbulb", title:"Mandelbulb", img:"/assets/showcase/svejstil.jpg", href:"https://gitlab.fit.cvut.cz/BI-PGA/b201/svejsond/blob/master/3D/dokumentace3.adoc", tags:["pga","blender","fractal"] },
      { id:"sc-linky-animation", title:"Linky animation", img:"/assets/showcase/cvut2.gif", href:"https://gitlab.fit.cvut.cz/BI-PGA/b201/spaneada/blob/master/gimp/dokumentace1.md", tags:["pga","gimp","animation"] },
      { id:"sc-edge-detect-material", title:"Edge Detect Material", img:"/assets/showcase/poncaada.png", href:"https://gitlab.fit.cvut.cz/BI-PGA/b201/poncaada", tags:["pga","blender","material"] },
      { id:"sc-seam-carving", title:"Seam carving", img:"/assets/showcase/kolemrad.png", href:"https://gitlab.fit.cvut.cz/BI-PGA/b201/kolemrad/blob/master/dokumentace1.md", tags:["pga","gimp","seam-carving"] },
      { id:"sc-gallifreyan-translator", title:"Gallifreyan translator", img:"/assets/showcase/kyselova.png", href:"https://gitlab.fit.cvut.cz/BI-PGA/b201/kyselba1", tags:["blender","simulation","bachelor"] },
      { id:"sc-blender-snow", title:"Blender Snow", img:"/assets/showcase/kacer.jpg", href:"https://gitlab.fit.cvut.cz/BI-PGA/b201/kacervik", tags:["pga","blender","snow"] },
      { id:"sc-decimation", title:"Decimation", img:"/assets/showcase/kvasnica.jpg", href:"https://gitlab.fit.cvut.cz/BI-PGA/b201/kvasnric", tags:["pga","blender","decimation"] },
      { id:"sc-magnificent-7", title:"Magnificent 7", img:"/assets/showcase/img_vhs_1.png", href:"https://youtu.be/SN_Pse347iI", tags:["vhs","unity","game"] },
      { id:"sc-pointless-pointers", title:"Pointless pointers", img:"/assets/showcase/img_vhs_2.png", href:"https://www.youtube.com/watch?v=4u3qrxFuULM&t=1s", tags:["vhs","pixel-art","game"] },
      { id:"sc-strahov-gang", title:"Strahov Gang", img:"/assets/showcase/img_vhs_3.png", href:"https://youtu.be/n1OENc6Fc2M?list=PLXhipPFpvUWH24SDRyFNhCUIuf8zIkM-m", tags:["vhs","unreal","game"] },
      { id:"sc-golf-town", title:"Golf Town", img:"/assets/showcase/img_vhs_4.png", href:"https://www.youtube.com/watch?v=OB7_UmOI_2U&t=6s", tags:["vhs","unity","vr","game"] },
      { id:"sc-poe-ripoff", title:"Path of Exile Ripoff", img:"/assets/showcase/img_vhs_5.png", href:"https://www.youtube.com/watch?v=7P3N3s81QqU&t=20s", tags:["vhs","unity","mmorpg","game"] },
      { id:"sc-ardaestra-magitech", title:"Ardaestra Magitech", img:"/assets/showcase/img_vhs_6.png", href:"https://youtu.be/Zz09tvnLEuo?list=PLXhipPFpvUWH24SDRyFNhCUIuf8zIkM-m", tags:["vhs","unity","rpg","game"] },
      { id:"sc-fitlife", title:"FitLife", img:"/assets/showcase/FitLife.png", href:"https://antik98.github.io/FitLife/", tags:["bachelor","pixel-art","game"] },
      { id:"sc-honza", title:"Honza", img:"/assets/showcase/honzaDetail.png", href:"https://www.youtube.com/watch?v=dhuMuopxlio&list=PLXhipPFpvUWEhSxw79CDOdjFFm5D6b3us&index=4&ab_channel=GrafitCTUFITPrague", tags:["vhs","pixel-art","game"] }
    ];

    /* ====== Slideshow nastavení ====== */
    const INTERVAL_SEC = Number(new URLSearchParams(location.search).get("speed")) || 15; // ?speed=10
    const SHUFFLE = (new URLSearchParams(location.search).get("shuffle")) === "1";       // ?shuffle=1
    const stage = document.getElementById("stage");
    const statusEl = document.getElementById("status");

    // Složit všechny položky do jednoho rotačního seznamu
    let rotation = [
      ...EVENTS.map(x => ({...x, kind:"event"})),
      ...RESEARCH.map(x => ({...x, kind:"research"})),
      ...SHOWCASE.map(x => ({...x, kind:"showcase"})),
    ];
    if (SHUFFLE) rotation = rotation.sort(()=>Math.random()-.5);

    let idx = 0, timer = null, playing = true;

    function createCard(item){
      const a = document.createElement("a");
      a.href = item.href || "#"; a.target = "_blank"; a.rel = "noreferrer";
      a.className = "card block rounded-2xl overflow-hidden border border-white/10 bg-gradient-to-b from-neutral-900 to-black";

      // poměr stran podle typu (research širší)
      const aspect = item.kind === "research" ? "aspect-[3/1]" : "aspect-[2/1]";
      const imgBox = document.createElement("div");
      imgBox.className = `relative w-full overflow-hidden ${aspect}`;
      const img = document.createElement("img");
      img.src = item.img; img.alt = item.title; img.loading="eager";
      img.className = "thumb h-full w-full object-cover object-center";
      imgBox.appendChild(img);
      // gradient + datum
      const grad = document.createElement("div");
      grad.className = "absolute inset-0 bg-gradient-to-t from-black/55 to-transparent";
      imgBox.appendChild(grad);
      if (item.date){
        const badge = document.createElement("span");
        badge.className = "absolute left-3 top-3 inline-flex items-center gap-1 rounded-full bg-black/60 px-2 py-1 text-xs text-neutral-200 border border-white/10";
        badge.textContent = "📅 " + item.date;
        imgBox.appendChild(badge);
      }
      a.appendChild(imgBox);

      // tělo
      const body = document.createElement("div");
      body.className = "p-5";
      const top = document.createElement("div");
      top.className = "flex items-baseline justify-between";
      const h3 = document.createElement("h3");
      h3.className = "text-2xl font-semibold text-neutral-100";
      h3.textContent = item.title;
      const kind = document.createElement("span");
      kind.className = "rounded-md border border-white/10 bg-white/5 px-2 py-0.5 text-xs uppercase tracking-wide text-neutral-300";
      kind.textContent = item.kind;
      top.appendChild(h3); top.appendChild(kind);
      body.appendChild(top);

      if (item.blurb){
        const p = document.createElement("p");
        p.className = "mt-2 text-neutral-300/90 text-base leading-relaxed";
        p.textContent = item.blurb;
        body.appendChild(p);
      }

      if ((item.tags||[]).length){
        const tg = document.createElement("div");
        tg.className = "mt-4 flex flex-wrap gap-2";
        item.tags.forEach(t=>{
          const chip = document.createElement("span");
          chip.className = "text-xs rounded-full border px-2 py-0.5 text-neutral-300 border-neutral-700/80";
          chip.textContent = "#"+t;
          tg.appendChild(chip);
        });
        body.appendChild(tg);
      }
      a.appendChild(body);
      return a;
    }

    function renderSlide(i){
      const item = rotation[i % rotation.length];

      // odjezd starého obsahu (fade-exit)
      if (stage.firstChild){
        const old = stage.firstChild;
        old.classList.add("fade-exit");
        requestAnimationFrame(()=>{
          old.classList.add("fade-exit-active");
          setTimeout(()=> stage.removeChild(old), 420);
        });
      }

      // příjezd nového obsahu (fade-enter)
      const wrap = document.createElement("div");
      wrap.className = "fade-enter";
      const card = createCard(item);
      wrap.appendChild(card);
      stage.appendChild(wrap);
      requestAnimationFrame(()=>{
        wrap.classList.add("fade-enter-active");
      });

      // stav lišta
      statusEl.textContent = (playing ? "⏵ běží" : "⏸ pauza") + " · " + INTERVAL_SEC + " s · " + (i+1) + "/" + rotation.length;
      document.title = `${item.title} — Grafit kiosk`;
    }

    function next(){ idx = (idx+1) % rotation.length; renderSlide(idx); }
    function prev(){ idx = (idx-1+rotation.length) % rotation.length; renderSlide(idx); }

    function play(){ if (timer) clearInterval(timer); timer = setInterval(next, INTERVAL_SEC*1000); playing = true; statusEl.textContent = "⏵ běží · " + INTERVAL_SEC + " s"; }
    function pause(){ if (timer) clearInterval(timer); timer = null; playing = false; statusEl.textContent = "⏸ pauza"; }

    // Ovládání
    document.getElementById("btnNext").onclick = ()=>{ pause(); next(); };
    document.getElementById("btnPrev").onclick = ()=>{ pause(); prev(); };
    document.getElementById("btnToggle").onclick = ()=>{ playing ? pause() : (play(), renderSlide(idx)); };
    document.addEventListener("keydown", (e)=>{
      if (e.code === "Space"){ e.preventDefault(); document.getElementById("btnToggle").click(); }
      if (e.key === "ArrowRight"){ document.getElementById("btnNext").click(); }
      if (e.key === "ArrowLeft"){ document.getElementById("btnPrev").click(); }
    });

    // Pozastavit při ztrátě fokus/viditelnosti (šetří výkon)
    document.addEventListener("visibilitychange", ()=>{
      if (document.hidden) pause();
      else if (!playing) { /* zůstane pauza */ } else play();
    });

    // Start
    renderSlide(idx);
    play();

    /* ====== Animované pozadí (lehce úsporné) ====== */
    function particles(canvas, {N=42, speed=.35}={}){
      const ctx = canvas.getContext("2d");
      let w=0,h=0, raf=0;
      const dots = Array.from({length:N}, ()=>({x:0,y:0,vx:(Math.random()-.5)*speed,vy:(Math.random()-.5)*speed}));
      function resize(){ w = canvas.width = innerWidth; h = canvas.height = innerHeight; }
      function reset(){ dots.forEach(d=>{ d.x=Math.random()*w; d.y=Math.random()*h; }); }
      function draw(){
        ctx.clearRect(0,0,w,h);
        const grad = ctx.createLinearGradient(0,0,w,h);
        grad.addColorStop(0,"#0b1220"); grad.addColorStop(1,"#0b0f16");
        ctx.fillStyle=grad; ctx.globalAlpha=.94; ctx.fillRect(0,0,w,h); ctx.globalAlpha=1;
        for(let i=0;i<N;i++){
          const a=dots[i]; a.x+=a.vx; a.y+=a.vy;
          if(a.x<0||a.x>w) a.vx*=-1; if(a.y<0||a.y>h) a.vy*=-1;
          for(let j=i+1;j<N;j++){
            const b=dots[j],dx=a.x-b.x,dy=a.y-b.y,d=Math.hypot(dx,dy);
            if(d<120){ ctx.globalAlpha = 1 - d/120; ctx.strokeStyle = "#60a5fa"; ctx.beginPath(); ctx.moveTo(a.x,a.y); ctx.lineTo(b.x,b.y); ctx.stroke(); ctx.globalAlpha=1; }
          }
          ctx.fillStyle="#22d3ee"; ctx.beginPath(); ctx.arc(a.x,a.y,1.2,0,Math.PI*2); ctx.fill();
        }
        raf = requestAnimationFrame(draw);
      }
      addEventListener("resize", resize);
      resize(); reset(); draw();
      return ()=>cancelAnimationFrame(raf);
    }
    particles(document.getElementById("backCanvas"), { N: 48, speed: .32 });
  </script>
</body>
</html>
